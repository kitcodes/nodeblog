<!doctype html>
<html>
<head>
<link rel="stylesheet" type="text/css" href="css/bootstrap.css"/>
<link rel="stylesheet" type="text/css" href="css/style.css"/>
<link rel="stylesheet" type="text/css" href="css/metrojs.css"/>
    
<!--For Full Page Flip-->    
<link rel="stylesheet" type="text/css" href="css/jquery.fullPage.css"/>    
</head>
<body>
   


<!-------------------->
<header>
                <div class="col-lg-12 col-sm-12 col-md-3">
                    <div class="col-lg-1 col-md-4 col-sm-12 dv-logo">
                        <a href="#">
                            <img src="img/logo.png"/>
                        </a>
                    </div>
                    <div class="col-lg-9 col-md-4 col-sm-12 dv-title">
                        <div class="row">
                            <div class="title-inner col-lg-6 col-md-6 col-sm-12">
                                <h1>
                                  Latest Technical Trends  
                                </h1>

                                <p>Explore Latest Stuff</p>
                            </div>
                            <div class="menu col-lg-6 col-md-6 col-sm-12">
                                <ul>
                                    <li><a class="active" href="">Home</a></li>
                                    <li><a href="">About Me</a></li>
                                    <li><a href="">Tech Stuff</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-2 col-sm-12 dv-member">
                        <a href="/auth/facebook" class="btn btn-default btn-login" data-bind="text:f_login, attr:{data_login:l_status, href:l_url}">Login with Facebook</a>
                        
                    </div>
                </div>

</header>
<div id="fullpage">
	
	<div class="section" id="section1">
	    <div class="slide">
			<!---Start of Main Page------->
            
            <div class="container container-middle">
                <div class="row">
                    <div class="col-lg-12 col-sm-12 col-md-12 middle-container">
                        <div class="row">
                            <div class="col-lg-12 col-md-12 col-sm-12 middle-inner">
                                <div class="dv-grid-main">
                                    <!-- ko foreach: blogs -->
                                        <!-- ko if:b_id===1-->
                                        <a data-bind="click:$parent.viewBlog, value:$parent.b_id" class="link_main">
                                            <div class="dv-large-grid">
                                            <img data-bind="attr:{ src: b_img_url }"/>
                                            <div class="black-banner">
                                                <h1 data-bind="text:b_title"></h1>
                                                <p data-bind="text:b_desc, trimText:b_desc, trimTextLength:70"></p>
                                            </div>
                                        </div>
                                        </a>
                                        <!-- /ko-->
                                    <!-- /ko-->
                                </div>
                                
                                <div class="dv-grid-main">
                                    <!-- ko foreach: blogs -->
                                        <!-- ko if:b_id!== 1 -->
                                        <div class="dv-grid-small">
                                            <a data-bind="click:$parent.viewBlog, value:$parent.b_id" class="link_main">
                                                <div class="content-dv">
                                                <img data-bind="attr:{ src: b_img_url }"/>
                                                <div class="black-banner">
                                                    <h1 data-bind="text:b_title"></h1>
                                                    <p data-bind="text:b_desc,trimText:b_desc, trimTextLength:60"></p>        
                                                </div>
                                            </div>
                                            </a>
                                        </div>
                                        <!-- /ko-->
                                    <!-- /ko-->
                                    <div class="dv-grid-small">
                                        
                                         <div class="mango">
                                            <div class="list-tile">

                                                <ul data-bind="foreach:categories_grouped" id="flip1" class="flip-list fourTiles" data-initdelay="500" data-mode="flip-list" data-delay="3000">
                                                    
                                                    <li data-bind="foreach:$data">
                                                        <div class="myClass"><img data-bind="attr:{src:$data.cat_img}" /></div>
                                                    </li>
                                                    
                                                </ul>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="bottom-content">
                <div class="container container-middle">
                    <div class="row">
                        <div class="col-lg-6 col-sm-12 col-md-6">
                            <select data-bind="event:{change: BlogOrderChange}" class="selectpicker">
                                <option value="1">Order By Date Asc</option>
                                <option value="2">Order By Date Desc</option>
                                <option value="3">Order By Title Asc</option>
                                <option value="4">Order By Title Desc</option>
                            </select>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-12">
                            <input type="text" data-bind="textInput:querySearch" placeholder="Search Blog"/>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-12 col-sm-12 col-md-12">
                            <div class="row">
                                <!-- ko foreach:filteredBlogs -->
                                <div class="col-lg-4 col-md-6 col-sm-12 dv-past-blog">
                                    <div class="dv-past-inner blue-content">
                                        <h1 class="blue" data-bind="text:b_title"></h1>
                                        <p data-bind="html:b_desc">
                                            
                                        </p>
                                        <div class="past-link">
                                            <a data-bind="click:$parent.viewBlog, value:$parent.b_id" href="">Read More ></a>
                                        </div>
                                    </div>
                                </div>
                                <!-- /ko -->
                            </div>
                        </div>
                    </div>
                </div>
            </div> 
            
            <!-----End of Main Page----->

		</div>
	    <div class="slide">
			<div class="intro">
				<h1 data-bind="text:view_title"></h1>
                <img data-bind="attr:{ src: view_img }"/>
                <p data-bind="html:view_desc"></p>

			</div>
		</div>
	    
	</div>
	
</div>

<!-------------------->    
    
<script src="js/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="js/bootstrap.min.js" type="text/javascript"></script>
<script src="js/metrojs.js" type="text/javascript"></script>  

<script src="js/knockout-3.4.0.js" type="text/javascript"></script>

<script src="js/jquery.fullPage.js" type="text/javascript"></script>    
<script src="https://cdn.socket.io/socket.io-1.3.5.js"></script>    

<script type="text/javascript">
    $(document).ready(function(){
        $("#demosMenu").change(function(){
          window.location.href = $(this).find("option:selected").attr("id") + '.html';
        });
    });
		$(document).ready(function() {
			$('#fullpage').fullpage({
				anchors: ['secondPage'],
				menu: '#menu',
				scrollingSpeed: 1000
			});

		});
</script>
<script type="text/javascript">
    
    
    
    blogModel = function(){
        
        var self = this;
        self.blogs = ko.observableArray([]);
        self.categories = ko.observableArray([]);
        self.allblogs = ko.observableArray([]);
        self.querySearch = ko.observable("");
        self.f_login = ko.observable();
        self.l_status = ko.observable();
        self.l_url = ko.observable();
        
        $.getJSON("http://localhost:5000/usersession", function(data){
            if(data.displayName != undefined){
                self.f_login(data.displayName);
                self.l_url='/logout';
                self.l_status(1);
            }
            else{
                self.f_login("Facebook Login");
                self.l_url='/auth/facebook';
                self.l_status(0);
            }
        });
        
        $.getJSON("http://localhost:5000/viewallblogs", function(data){
            self.blogs(data);
        });
        
        $.getJSON("http://localhost:5000/viewoverallblogs", function(data){
            self.allblogs(data);
        });
        
        $.getJSON("http://localhost:5000/viewcategories", function(data){
            self.categories(data);
            $(".flip-list").liveTile();
        });
        
        self.filteredBlogs = ko.computed(function(){
            var querySearch = self.querySearch().toLowerCase();
            if(!querySearch){
                return self.allblogs();
            }
            else{
               return ko.utils.arrayFilter(self.allblogs(), function(item){
                   return item.b_title.toLowerCase().indexOf(querySearch) !== -1 || item.b_desc.toLowerCase().indexOf(querySearch) !== -1;
               }); 
            }
        });
        
        self.BlogOrderChange = function(obj, event){
            if(event.target.value == 1){
                self.allblogs(self.allblogs().sort(function(a,b){return a.b_id > b.b_id}));
            }
            else if(event.target.value == 2){
                self.allblogs(self.allblogs().sort(function(a,b){return a.b_id < b.b_id}));
            }
            else if(event.target.value == 3){
                self.allblogs(self.allblogs().sort(function(a,b){return a.b_title > b.b_title}));
            }
            else if(event.target.value == 4){
                self.allblogs(self.allblogs().sort(function(a,b){return a.b_title < b.b_title}));
            }
        }
        
        
        
       /* self.blogs = ko.observableArray([
                { title: 'KNOCKOUT JS WITH NODEJS', desc: 'Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql', b_id:'1' ,img:'img/node_js.png'},
                { title: 'SOCIAL MEDIA TRENDS', desc: 'Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql', b_id:'2' ,img:'img/social-media.png'},
                { title: 'SOCIAL MEDIA MARKETING', desc: 'Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql', b_id:'3',img:'img/socia-all.jpg'},
                { title: 'SOCIAL MEDIA TRENDS', desc: 'Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql Basic Introduction about Knockout and NodeJS with MySqlBasic Introduction about Knockout and NodeJS with MySql', b_id:'4',img:'img/social-media.png'},
                { title: '', desc: '', b_id:'5',img:''}

        ]);
        
        self.categories = ko.observableArray([
            {cat_name:"Knockout", cat_image:"img/knck.jpg", cat_id:"1"},
            {cat_name:"Node", cat_image:"img/node.jpeg", cat_id:"2"},
            {cat_name:"Mongo", cat_image:"img/mongodb.png", cat_id:"3"},
            {cat_name:"Angular", cat_image:"img/angular.png", cat_id:"4"},
            {cat_name:"UX", cat_image:"img/ux.png", cat_id:"5"},
            {cat_name:"SocialMedia", cat_image:"img/social.jpg", cat_id:"6"},
            {cat_name:"Apple", cat_image:"img/apple.jpg", cat_id:"7"},
            {cat_name:"Apple", cat_image:"img/software.jpg", cat_id:"8"},
        ]);
        */
        setInterval(
            function(){
                    self.categories_grouped = ko.computed(function(){

                    var rows = [], current = [];
                    rows.push(current);

                    for(var i = 0; i < self.categories().length; i++){

                        current.push(self.categories()[i]);
                        if((i+1) % 2 === 0){
                            current = [];
                            rows.push(current);
                        }

                    }
                    console.log(rows);
                    return rows;


                },self.categories());
            },2000);
        self.categories_grouped = ko.computed(function(){
            
            var rows = [], current = [];
            rows.push(current);
            
            for(var i = 0; i < self.categories().length; i++){
                
                current.push(self.categories()[i]);
                if((i+1) % 2 === 0){
                    current = [];
                    rows.push(current);
                }
                
            }
            console.log(rows);
            return rows;
            
            
        },self.categories());
        
        self.selected_bid = ko.observable("");
        self.selected_desc = ko.observable("");
        self.selected_title = ko.observable("");
        self.selected_img = ko.observable("");

        
        self.b_id = ko.observable();
        self.view_title = ko.observable();
        self.view_desc = ko.observable();
        self.view_img = ko.observable();

        self.all_blogs = ko.observableArray([]);
        
        self.viewBlog = function(){
            self.selected_bid(this.b_id);

            
            $('.fp-controlArrow.fp-next').click();
            bId = {"blog_id":self.selected_bid()};
            $.post("http://localhost:5000/viewoneblog", bId, function(response){
                self.view_title(response[0].b_title);
                self.view_desc(response[0].b_desc);
                self.view_img(response[0].b_img_url);
            });
            

        };
        
        self.loadBlogs = function(){
            /*$.getJSON("this.json",function (timesheets, status) {
                console.log(status);
                self.timesheets.removeAll();
                self.timesheets(timesheets)
                }
            );
            */
           
        };
        
        self.loadBlogs();
    };
    
    var bModel = new blogModel();
    
    ko.bindingHandlers.trimLength = {};
    ko.bindingHandlers.trimText = {
        
        init:function(element, valueAccessor, allBindingsAccessor, viewModel){
            
            var trimmedText = ko.computed(function(){
                
                var unTrimmedText = ko.utils.unwrapObservable(valueAccessor());
                var defaultLength = 20;
                var minLength = 5;
                
                var maxLength = ko.utils.unwrapObservable(allBindingsAccessor().trimTextLength);
                
                if(maxLength < minLength) maxLength = minLength;
                var text = unTrimmedText.length > maxLength ? unTrimmedText.substring(0, maxLength - 1) + '...':unTrimmedText;
                return text;
                
                });
            
            ko.applyBindingsToNode(element,{
                text:trimmedText
            }, viewModel);
        }
        
    };
    
    ko.applyBindings(bModel);
    
    
    
</script>    
  
</body>
</html>